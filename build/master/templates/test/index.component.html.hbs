<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Tests</title>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <link rel="stylesheet" href="../build/build.css" />
  <script type="text/javascript" src="../build/build.js"></script>
  <script type="text/javascript">
    window.onload = function() {
      // setup mocha
      var ScreencastReporter = require('mocha-screencast-reporter');
      require('mocha');
      mocha.setup('bdd');
      //mocha.checkLeaks();
      mocha.reporter(ScreencastReporter);

      // require tests
      for (var m in require.modules) {
        if (m.match(/^.*\/test\/.*_test.js$/)) {
          require(m);
        }
      }

      // run tests
      var runner = mocha.run();

      // check if ended (with sauce labs issues)
      var count = 5,
          check = setInterval(function(){
        if (runner.stats.end) {
          window.mochaResults = runner.stats;
          if(count>0){
            count--;
          }else{
            clearInterval(check);
          }
        }
      }, 1000);
    };
  </script>
</head>
<body>
  <div id="mocha"></div>

</body>
</html>
